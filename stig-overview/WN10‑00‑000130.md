# WN10‑00‑000130 – Remove Certificate Installation Files

## Description
This control requires that certificate installation files with extensions `.p12` and `.pfx` be removed from Windows 10 systems. These files are often used to install software-based certificates and pose a security risk if left on disk.

## Vulnerability / Risk
Software certificates and their accompanying installation files are less secure than hardware-based certificates. If left on the system, they can be extracted and misused by attackers to gain unauthorized access or impersonate users.

## More Information
- [Tenable Audits](https://www.tenable.com/audits/items/DISA_STIG_Microsoft_Windows_10_v3r4.audit:8c63ef7f47d4db448f5a06d82c984ee9)
- [STIG-A-View](https://stigaview.com/products/win10/v3r4/WN10-00-000130/)

## Rollback Instructions
If a certificate installation file was removed in error and is still required for a specific server-based application (e.g., Oracle Wallet Manager or Adobe PreFlight), you may restore it from a secure backup and document its purpose with the ISSO.

## Rollback Script
```powershell
# Rollback: Restore known .p12 and .pfx files from backup (customize path)
$backupPath = "D:\CertBackup"
$restorePath = "C:\RestoredCerts"

if (!(Test-Path $restorePath)) {
    New-Item -ItemType Directory -Path $restorePath | Out-Null
}

Get-ChildItem -Path $backupPath -Include *.p12, *.pfx -Recurse | ForEach-Object {
    $destination = Join-Path $restorePath $_.Name
    Copy-Item $_.FullName -Destination $destination -Force
    Write-Host "Restored: $($_.Name) to $restorePath"
}

```
